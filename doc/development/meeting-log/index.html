<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>meeting-log</title>

<link rel="stylesheet" href="../../../style.css" type="text/css" />

<link rel="stylesheet" href="../../../local.css" type="text/css" />


<link rel="alternate" type="application/x-wiki" title="Edit this page" href="https://github.com/project-renard/project-renard.github.io/edit/source/doc/development/meeting-log/index.mdwn" />

<link rel="alternate" type="application/rss+xml" title="Project Renard (RSS feed)" href="index.rss" /><link rel="alternate" type="application/atom+xml" title="Project Renard (Atom feed)" href="index.atom" />


</head>
<body>

<div class="page">

<div class="pageheader">
<div class="header">
<span>
<span class="parentlinks">

<a href="../../../">Project Renard</a>/ 

<a href="../../">doc</a>/ 

<a href="../">development</a>/ 

</span>
<span class="title">
meeting-log

</span>
</span>

</div>


<div class="actions">
<ul>

<li><a href="https://github.com/project-renard/project-renard.github.io/edit/source/doc/development/meeting-log/index.mdwn" rel="nofollow">Edit</a></li>


<li><a href="../../../recentchanges/">RecentChanges</a></li>


<li><a href="https://github.com/project-renard/project-renard.github.io/commits/source/doc/development/meeting-log/index.mdwn">History</a></li>







</ul>
</div>




</div>


<div class="sidebar">
<ul>
    <li><a href="../../">Documentation</a></li>
    <ul>
        <li><span class="selflink">Development meeting log</span></li>
        <li><a href="../">Development</a></li>
        <li><a href="../../survey/">Survey</a></li>
        <li><a href="../../design/">Design</a></li>
    </ul>
    <li><a href="../../../about/">About</a></li>
</ul>

</div>


<div id="pagebody">

<div id="content">
<div  class="feedlink">

<a class="feedbutton" type="application/rss+xml" rel="alternate" title="Project Renard (RSS feed)" href="index.rss">RSS</a>


<a class="feedbutton" type="application/atom+xml" rel="alternate" title="Project Renard (Atom feed)" href="index.atom">Atom</a>

</div>
<div class="inlinepage">

<div class="inlineheader">

<span class="header">

<a href="./posts/2016/05/03/windows-build-with-msys2/">Windows build with MSYS2: locally and on Appveyor (now with New Debugging Flavour!)</a>

</span>
</div>

<div class="inlinecontent">
<p>In order to build <a href="https://github.com/project-renard/curie">curie</a> on Windows<a href="#fn:portability" id="fnref:portability" class="footnote">1</a>,
we need to build the various Perl dependencies. These Perl dependencies in turn
require native libraries such as Gtk+ 3 and MuPDF. Using the MSYS2 package manager, we
can install the native libraries and link against them.</p>

<p>The following steps show how to install the dependencies along with how I ended
up debugging the build. I'm writing out this post in case the debugging steps
are useful months later when I forget how or why I did things.</p>

<p>The following will be assuming 64-bit Windows (x86-64
architecture) throughout.</p>

<h2 id="buildinglocally">Building locally</h2>

<ol>

<li>
   Install <a href="https://msys2.github.io/">MSYS2</a>. This is a straightforward install
   into the <code>C:\msys64</code> directory.
</li>

<li>
   Start the "MinGW-w64 Win64 Shell" from the Start Menu. This shell sets up
   the proper environment variables needed to use 64-bit libraries for the
   MinGW64 system.
</li>

<li>
   Use the <a href="https://www.archlinux.org/pacman/pacman.8.html">pacman</a> package
   manager to update the package database and install the build toolchain.

   <pre class="hl">   pacman <span class="hl opt">-</span>Syu  <span class="hl slc"># update</span>

   <span class="hl slc"># Install compiler and build configuration tools</span>
   pacman <span class="hl opt">-</span>S <span class="hl opt">--</span>needed <span class="hl opt">--</span>noconfirm mingw<span class="hl opt">-</span>w64<span class="hl opt">-</span>x86_64<span class="hl opt">-</span>toolchain autoconf automake libtool <span class="hl kwc">make patch</span> mingw<span class="hl opt">-</span>w64<span class="hl opt">-</span>x86_64<span class="hl opt">-</span>libtool

</pre>
</li>

<li>
   Install the native dependencies.

   <pre class="hl">   pacman <span class="hl opt">-</span>S <span class="hl opt">--</span>needed <span class="hl opt">--</span>noconfirm \
       mingw<span class="hl opt">-</span>w64<span class="hl opt">-</span>x86_64<span class="hl opt">-</span>gobject<span class="hl opt">-</span>introspection \
       mingw<span class="hl opt">-</span>w64<span class="hl opt">-</span>x86_64<span class="hl opt">-</span>cairo \
       mingw<span class="hl opt">-</span>w64<span class="hl opt">-</span>x86_64<span class="hl opt">-</span>gtk3 \
       mingw<span class="hl opt">-</span>w64<span class="hl opt">-</span>x86_64<span class="hl opt">-</span>expat \
       mingw<span class="hl opt">-</span>w64<span class="hl opt">-</span>x86_64<span class="hl opt">-</span>openssl

</pre>
</li>

<li>
   Install Perl and cpanm

   <pre class="hl">   pacman <span class="hl opt">-</span>S <span class="hl opt">--</span>needed <span class="hl opt">--</span>noconfirm mingw<span class="hl opt">-</span>w64<span class="hl opt">-</span>x86_64<span class="hl opt">-</span>perl
   <span class="hl kwc">yes</span> | cpan App<span class="hl opt">::</span>cpanminus

</pre>

   However, we ecounter a problem with this last command.

   <pre>   Configuring M/MI/MIYAGAWA/App-cpanminus-1.7040.tar.gz with Makefile.PL
   Checking if your kit is complete...
   Looks good
   Generating a dmake-style Makefile
   Writing Makefile for App::cpanminus
   Writing MYMETA.yml and MYMETA.json
     MIYAGAWA/App-cpanminus-1.7040.tar.gz
     C:\msys64\mingw64\bin\perl.exe Makefile.PL -- OK
   Running make for M/MI/MIYAGAWA/App-cpanminus-1.7040.tar.gz
   cp lib/App/cpanminus/fatscript.pm blib\lib\App\cpanminus\fatscript.pm
   cp lib/App/cpanminus.pm blib\lib\App\cpanminus.pm
   "C:\msys64\mingw64\bin\perl.exe" -MExtUtils::Command -e cp -- bin/cpanm blib\script\cpanm
   pl2bat.bat blib\script\cpanm
   'pl2bat.bat' is not recognized as an internal or external command,
   operable program or batch file.
   dmake:  Error code 129, while making 'blib\script\cpanm'
   dmake:  'blib\script\cpanm' removed.
     MIYAGAWA/App-cpanminus-1.7040.tar.gz
     dmake -- NOT OK
   </pre>

   The important line here is

   <pre>   'pl2bat.bat' is not recognized as an internal or external command,
   </pre>

   It tries to using <code>pl2bat.bat</code> to install the <code>cpanm</code>
   script, but it is missing. Let's take a look:

   <pre>   $ which pl2bat.bat
   which: no pl2bat.bat in (...)
   </pre>

   OK, so it is not there. What about without the <code>.bat</code> extension?

   <pre>   # Where is pl2bat?
   $ which pl2bat
   /mingw64/bin/pl2bat

   # What does the beginning of the file look like.
   $ head -1 $(which pl2bat)
   #!perl -w
   </pre>

   OK, so it does exist and is a Perl script. We just need it be a Windows batch file.

   <dl>
       <dt>Note about <code>pl2bat</code></dt>
       <dd>
       The <code>pl2bat</code> command is a tool that is used on Windows in order to allow for
       running Perl scripts without having to specify that they must run under Perl.
       So instead of having to type <code>perl myscript</code> to run code in the <code>myscript</code>
       file, we can just type <code>myscript</code> and run it as if it was just another
       executable. This works by wrapping the original code and placing it into a
       Windows batch file that calls the Perl interpreter on the same file.
       </dd>
   </dl>

   It turns out that MSYS2 has the Perl script <code>pl2bat</code> which does
   the conversion, but that file was not converted itself! To do that we find the
   path for the <code>pl2bat</code> file and run <code>pl2bat</code> on it.

   <pre class="hl">   pl2bat $<span class="hl opt">(</span><span class="hl kwc">which</span> pl2bat<span class="hl opt">)</span>

</pre>

   We can then install <code>cpanm</code> as before and it works.

   <pre class="hl">   <span class="hl kwc">yes</span> | cpan App<span class="hl opt">::</span>cpanminus

</pre>
</li>

<li>
   Install the Perl dependencies for curie itself by running the following in a copy of the
   <code>curie</code> repository:

   <pre class="hl">   cpanm <span class="hl opt">--</span>installdeps .

</pre>

   This reads the <code>cpanfile</code> which lists the Perl prerequisites for
   the project and installs everything needed to build, run, and test the code.

   But we hit an issue here when it attempts to install Gtk3 and in turn
   its dependency Glib.

   <pre>   $ cpanm -f Glib
   --&gt; Working on Glib
   Fetching http://www.cpan.org/authors/id/X/XA/XAOC/Glib-1.321.tar.gz ... OK
   Configuring Glib-1.321 ... OK
   Building and testing Glib-1.321 ... ! Installing Glib failed. See C:\msys64\...\build.log for details. Retry with --force to force install it.
   FAIL
   </pre>

   Let's take a closer look at what is happening with Glib by adding the <code>--verbose</code> flag:

   <pre>   $ cpanm --verbose Glib
   # [ redacted configuration output ]
   # [ redacted compilation output ]
   [ LD blib\arch\auto\Glib\Glib.dll ]
   Glib.o:Glib.c:(.text+0x156d): undefined reference to `__imp_glib_major_version'
   Glib.o:Glib.c:(.text+0x15a3): undefined reference to `__imp_glib_minor_version'
   Glib.o:Glib.c:(.text+0x15b1): undefined reference to `__imp_glib_micro_version'
   Glib.o:Glib.c:(.text+0x15e8): undefined reference to `__imp_glib_micro_version'
   Glib.o:Glib.c:(.text+0x1603): undefined reference to `__imp_glib_minor_version'
   Glib.o:Glib.c:(.text+0x160a): undefined reference to `__imp_glib_micro_version'
   GUtils.o:GUtils.c:(.text+0x573): undefined reference to `__imp_glib_micro_version'
   GUtils.o:GUtils.c:(.text+0x583): undefined reference to `__imp_glib_minor_version'
   GUtils.o:GUtils.c:(.text+0x593): undefined reference to `__imp_glib_major_version'
   GParamSpec.o:GParamSpec.c:(.text+0x2ee4): undefined reference to `__imp_g_param_spec_types'
   GParamSpec.o:GParamSpec.c:(.text+0x3032): undefined reference to `__imp_g_param_spec_types'
   GParamSpec.o:GParamSpec.c:(.text+0x3152): undefined reference to `__imp_g_param_spec_types'
   GParamSpec.o:GParamSpec.c:(.text+0x3292): undefined reference to `__imp_g_param_spec_types'
   GParamSpec.o:GParamSpec.c:(.text+0x3347): undefined reference to `__imp_g_param_spec_types'
   GParamSpec.o:GParamSpec.c:(.text+0x3422): more undefined references to `__imp_g_param_spec_types' follow
   C:\msys64\mingw64\lib\libgobject-2.0.a(libgobject_2_0_la-gclosure.o):(.text+0x222e): undefined reference to `ffi_prep_cif'
   C:\msys64\mingw64\lib\libgobject-2.0.a(libgobject_2_0_la-gclosure.o):(.text+0x224e): undefined reference to `ffi_call'
   C:\msys64\mingw64\lib\libgobject-2.0.a(libgobject_2_0_la-gclosure.o):(.text+0x2607): undefined reference to `ffi_prep_cif'
   C:\msys64\mingw64\lib\libgobject-2.0.a(libgobject_2_0_la-gclosure.o):(.text+0x262f): undefined reference to `ffi_call'
   C:\msys64\mingw64\lib\libgobject-2.0.a(libgobject_2_0_la-gclosure.o):(.rdata$.refptr.ffi_type_void[.refptr.ffi_type_void]+0x0): undefined reference to `ffi_type_void'
   C:\msys64\mingw64\lib\libgobject-2.0.a(libgobject_2_0_la-gclosure.o):(.rdata$.refptr.ffi_type_uint64[.refptr.ffi_type_uint64]+0x0): undefined reference to `ffi_type_uint64'
   C:\msys64\mingw64\lib\libgobject-2.0.a(libgobject_2_0_la-gclosure.o):(.rdata$.refptr.ffi_type_sint64[.refptr.ffi_type_sint64]+0x0): undefined reference to `ffi_type_sint64'
   C:\msys64\mingw64\lib\libgobject-2.0.a(libgobject_2_0_la-gclosure.o):(.rdata$.refptr.ffi_type_double[.refptr.ffi_type_double]+0x0): undefined reference to `ffi_type_double'
   C:\msys64\mingw64\lib\libgobject-2.0.a(libgobject_2_0_la-gclosure.o):(.rdata$.refptr.ffi_type_float[.refptr.ffi_type_float]+0x0): undefined reference to `ffi_type_float'
   C:\msys64\mingw64\lib\libgobject-2.0.a(libgobject_2_0_la-gclosure.o):(.rdata$.refptr.ffi_type_pointer[.refptr.ffi_type_pointer]+0x0): undefined reference to `ffi_type_pointer'
   C:\msys64\mingw64\lib\libgobject-2.0.a(libgobject_2_0_la-gclosure.o):(.rdata$.refptr.ffi_type_uint32[.refptr.ffi_type_uint32]+0x0): undefined reference to `ffi_type_uint32'
   C:\msys64\mingw64\lib\libgobject-2.0.a(libgobject_2_0_la-gclosure.o):(.rdata$.refptr.ffi_type_sint32[.refptr.ffi_type_sint32]+0x0): undefined reference to `ffi_type_sint32'
   C:\msys64\mingw64\lib\libglib-2.0.a(libglib_2_0_la-gmain.o):(.text+0x25c8): undefined reference to `__imp_timeGetTime'
   C:\msys64\mingw64\lib\libglib-2.0.a(libglib_2_0_la-gmain.o):(.text+0x2608): undefined reference to `__imp_timeGetTime'
   C:\msys64\mingw64\lib\libglib-2.0.a(libglib_2_0_la-gregex.o):(.text+0x1a6): undefined reference to `pcre_get_stringtable_entries'
   C:\msys64\mingw64\lib\libglib-2.0.a(libglib_2_0_la-gregex.o):(.text+0x231): undefined reference to `pcre_get_stringnumber'
   C:\msys64\mingw64\lib\libglib-2.0.a(libglib_2_0_la-gregex.o):(.text+0xa36): undefined reference to `pcre_exec'
   C:\msys64\mingw64\lib\libglib-2.0.a(libglib_2_0_la-gregex.o):(.text+0x132f): undefined reference to `pcre_compile2'
   C:\msys64\mingw64\lib\libglib-2.0.a(libglib_2_0_la-gregex.o):(.text+0x134d): undefined reference to `pcre_fullinfo'
   C:\msys64\mingw64\lib\libglib-2.0.a(libglib_2_0_la-gregex.o):(.text+0x13c9): undefined reference to `pcre_fullinfo'
   C:\msys64\mingw64\lib\libglib-2.0.a(libglib_2_0_la-gregex.o):(.text+0x1b44): undefined reference to `pcre_fullinfo'
   C:\msys64\mingw64\lib\libglib-2.0.a(libglib_2_0_la-gregex.o):(.text+0x1d9c): undefined reference to `pcre_study'
   C:\msys64\mingw64\lib\libglib-2.0.a(libglib_2_0_la-gregex.o):(.text+0x1e9d): undefined reference to `pcre_config'
   C:\msys64\mingw64\lib\libglib-2.0.a(libglib_2_0_la-gregex.o):(.text+0x1eb4): undefined reference to `pcre_config'
   C:\msys64\mingw64\lib\libglib-2.0.a(libglib_2_0_la-gregex.o):(.text+0x1f98): undefined reference to `pcre_fullinfo'
   C:\msys64\mingw64\lib\libglib-2.0.a(libglib_2_0_la-gregex.o):(.text+0x1fc8): undefined reference to `pcre_fullinfo'
   C:\msys64\mingw64\lib\libglib-2.0.a(libglib_2_0_la-gregex.o):(.text+0x1ff8): undefined reference to `pcre_fullinfo'
   C:\msys64\mingw64\lib\libglib-2.0.a(libglib_2_0_la-gregex.o):(.text+0x2028): undefined reference to `pcre_fullinfo
   </pre>

   OK, that's a lot of errors. Seems that the linker phase (<code>ld</code>)
   has failed to find several function names in the <code>libglib-2.0.a</code> and
   <code>libgobject-2.0.a</code> library files.

   <dl>
     <dt>
       Note about library files on Windows
     </dt>
     <dd>
       We see that that library files above both end in the <code>.a</code> extension (for
       archive). This indicates that this is a static library which means
       symbols such as function names get resolved at linking time through
       <em>static linking</em>.

       We can also resolve symbols at runtime through <em>dynamic linking</em>.
       These files have the extension <code>.dll</code> on Windows.
     <dd>
   </dl>

   Let's take a look at what we expect the linker
   flags to be for <code>libglib</code> and <code>libgobject</code> by using
   the <code>pkg-config</code> command:

   <pre>   # Find the name of the glib and gobject library packages
   $ pkg-config --list-all | grep glib\|gobject
   glib-2.0                            GLib - C Utility Library
   gobject-2.0                         GObject - GLib Type, Object, Parameter and Signal Library

   # Get the linker flags
   $ pkg-config --libs glib-2.0 gobject-2.0
   -LC:/msys64/mingw64/lib -lgobject-2.0 -lglib-2.0 -lintl
   </pre>

   OK, that looks reasonable. But we see the above errors refer to functions
   that are prefixed with <code>ffi_</code> and <code>pcre_</code>. The
   convention for C libraries is that the prefix referse to the libraries that
   the functions came from. But we don't see any flags for those libraries
   (<code>-lffi -lpcre</code>). So when linker attempts static linking against
   the <code>.a</code> files, it does not know that the other libraries are
   needed.

   We can try to get the linker flags for static linking by adding the
   <code>--static</code> flag to <code>pkg-config</code>

   <pre>   # Get the static linker flags
   $ pkg-config --static --libs glib-2.0 gobject-2.0
   -LC:/msys64/mingw64/lib -LC:/msys64/mingw64/lib/../lib -LC:/msys64/mingw64/lib -lgobject-2.0 -lffi -lglib-2.0 -lintl -pthread -lws2_32 -lole32 -lwinmm -lshlwapi -lpcre -lintl -lpcre
   """]

   Ah, there we go! Let's compare this to what the Glib module uses when linking:

   [[!format txt </pre>

   OK, wait, what's this? We get the list of dynamic linker flags where it says
   "Potential libraries", but when it says "Result:", a couple of those flags
   become paths to the corresponding <code>.a</code> files. Let's run
   <code>dmake</code> with the
   <code><a href="https://metacpan.org/pod/ExtUtils::MakeMaker#NOECHO">NOECHO</a></code>
   flag to see what is going on:


   <pre>   Glib-1.321 $ dmake NOECHO=''
   # [ redacted output ] 
   [ LD blib\arch\auto\Glib\Glib.dll ]
   g++ Glib.def -o blib\arch\auto\Glib\Glib.dll -mdll -s -L"C:\msys64\mingw64\lib\perl5\core_perl\CORE" -L"C:\msys64\mingw64\lib" Glib.o GError.o GUtils.o GLog.o GType.o GBoxed.o GObject.o GValue.o GClosure.o GSignal.o GMainLoop.o GIOChannel.o GParamSpec.o GKeyFile.o GOption.o GBookmarkFile.o GVariant.o gperl-gtypes.o   "C:\msys64\mingw64\lib\perl5\core_perl\CORE\libperl522.a" "C:\msys64\mingw64\lib\libgobject-2.0.a" "C:\msys64\mingw64\lib\libglib-2.0.a" "C:\msys64\mingw64\lib\libintl.a" "C:\msys64\mingw64\lib\libgthread-2.0.a" -Wl,--enable-auto-image-base
   Glib.o:Glib.c:(.text+0x156d): undefined reference to `__imp_glib_major_version'
   Glib.o:Glib.c:(.text+0x15a3): undefined reference to `__imp_glib_minor_version'
   Glib.o:Glib.c:(.text+0x15b1): undefined reference to `__imp_glib_micro_version'
   # [ rest of the linker errors as before ]
   </pre>

   OK, so here we see that all the dynamic linker flags are using the full
   paths to the <code>.a</code> files. Let's take a look at how
   <code>Makefile.PL</code> passes on this information to the <code>Makefile</code>

   <pre>   Glib-1.321 $ grep libgobject-2.0.a Makefile
   EXTRALIBS = "C:\msys64\mingw64\lib\libgobject-2.0.a" "C:\msys64\mingw64\lib\libglib-2.0.a" "C:\msys64\mingw64\lib\libintl.a" "C:\msys64\mingw64\lib\libgthread-2.0.a"
   LDLOADLIBS = "C:\msys64\mingw64\lib\libgobject-2.0.a" "C:\msys64\mingw64\lib\libglib-2.0.a" "C:\msys64\mingw64\lib\libintl.a" "C:\msys64\mingw64\lib\libgthread-2.0.a"
   # EXTRALIBS =&gt; q["C:\msys64\mingw64\lib\libgobject-2.0.a" "C:\msys64\mingw64\lib\libglib-2.0.a" "C:\msys64\mingw64\lib\libintl.a" "C:\msys64\mingw64\lib\libgthread-2.0.a"]
   # LDLOADLIBS =&gt; q["C:\msys64\mingw64\lib\libgobject-2.0.a" "C:\msys64\mingw64\lib\libglib-2.0.a" "C:\msys64\mingw64\lib\libintl.a" "C:\msys64\mingw64\lib\libgthread-2.0.a"]
   </pre>]

   So it appears that <code>ExtUtils::MakeMaker</code> is setting the EXTRALIB
   and LDLOADLIBS variables. Let's try setting them ourselves to the output of
   <code>pkg-config</code>:

   <pre>   Glib-1.321 $ export GLIB_PKG_CONFIG="$(pkg-config --libs gobject-2.0 glib-2.0)"
   Glib-1.321 $ dmake NOECHO='' LDLOADLIBS="$GLIB_PKG_CONFIG" EXTRALIBS="$GLIB_PKG_CONFIG"
   </pre>

   It built successfully! This means that there is a problem with using the
   full path to the <code>.a</code> files. We need to see why
   <code>EXTRALIBS</code> and <code>LDLOADLIBS</code> are being set the way
   they are.

   Let's search the distribution for documentation about these variables by
   going to the <a href="https://metacpan.org/release/ExtUtils-MakeMaker">distribution's page on MetaCPAN</a>
   and typing the query <code>EXTRALIBS LDLOADLIBS</code> in the search box:

   <table class="img"><caption>Screenshot of the ExtUtils-MakeMaker page highlighting the Search Distribution field</caption><tr><td><a href="./posts/2016/05/03/gfx/metacpan-search-eumm-highlight.png"><img src="./posts/2016/05/03/windows-build-with-msys2/250x-metacpan-search-eumm-highlight.png" width="250" height="255" class="img" /></a></td></tr></table>

   Looking at the results
   <a href="https://metacpan.org/search?q=dist%3AExtUtils-MakeMaker+EXTRALIBS+LDLOADLIBS&search_type=modules">results</a>,
   we see <a href="https://metacpan.org/pod/ExtUtils::Liblist">ExtUtils::Liblist</a> and <a href="https://metacpan.org/pod/ExtUtils::MM_Unix">ExtUtils::MM_Unix</a>.

   <table class="img"><caption>Screenshot of the results of the query for LIB Makefile variables</caption><tr><td><a href="./posts/2016/05/03/gfx/metacpan-search-eumm-libs-results.png"><img src="./posts/2016/05/03/windows-build-with-msys2/250x-metacpan-search-eumm-libs-results.png" width="250" height="123" class="img" /></a></td></tr></table>

   The ExtUtils::Liblist looks promising. In <a href="https://metacpan.org/pod/release/BINGOS/ExtUtils-MakeMaker-7.14/lib/ExtUtils/Liblist.pm">version 7.14</a> of the documentation, there's a section about the Win32
   behaviour:
   <blockquote>
   An entry of the form <code>-lfoo</code> specifies the library <code>foo</code>,
   which may be spelled differently depending on what kind of compiler you are
   using. If you are using GCC, it gets translated to <code>libfoo.a</code>, but
   for other win32 compilers, it becomes <code>foo.lib</code>.
   </blockquote>

   So the translation to full paths is a part of the design. Reading further, we see
   <blockquote>
   An entry that matches <code>/:nosearch/i</code> disables all searching for the libraries specified after it.
   </blockquote>

   So if we but <code>:nosearch</code> in the <a href="https://metacpan.org/pod/ExtUtils::MakeMaker#LIBS">LIBS parameter</a> of the function
   that generates the <code>Makefile</code>, (i.e., <code>WriteMakefile</code>). Let's try that

   <pre>   $ cpanm --look Glib
   Glib-1.321 $ export GLIB_PKG_CONFIG="$(pkg-config --libs gobject-2.0 glib-2.0)"
   Glib-1.321 $ perl Makefile.PL LIBS=":nosearch $GLIB_PKG_CONFIG" verbose
   # [ remove extra output ]
   Potential libraries are ':nosearch -LC:/msys64/mingw64/lib -lgobject-2.0 -lglib-2.0 -lintl -lmoldname -lkernel32 -luser32 -lgdi32 -lwinspool -lcomdlg32 -ladvapi32 -lshell32 -lole32 -loleaut32 -lnetapi32 -luuid -lws2_32 -lmpr -lwinmm -lversion -lodbc32 -lodbccp32 -lcomctl32':
   Result: "-LC:\msys64\mingw64\lib" "-lgobject-2.0" "-lglib-2.0" "-lintl" "-lmoldname" "-lkernel32" "-luser32" "-lgdi32" "-lwinspool" "-lcomdlg32" "-ladvapi32" "-lshell32" "-lole32" "-loleaut32" "-lnetapi32" "-luuid" "-lws2_32" "-lmpr" "-lwinmm" "-lversion" "-lodbc32" "-lodbccp32" "-lcomctl32"
   # [ remove extra output ]
   Glib-1.321 $ dmake NOECHO=''
   </pre>

   Hey, it's working!

   So now we know that all we need is to put
   <code>:nosearch</code> in the <code>LIBS</code> parameter and it will build.
   But that's still problematic, because if I try to install any module, I will
   have to open it up to find out what it is passing in to LIBS and copy that
   into the command line for the configuration step.

   I popped into the <code>#toolchain</code> IRC channel on the
   <code>irc.perl.org</code> network to share what I had learned and ask
   if there was another way forward. After a quick convo with
   <code><a href="https://metacpan.org/author/MSTROUT">mst</a>++</code>, he came back
   with a one-liner that wrapped the <code>WriteMakefile</code> function and inserted
   <code>:nosearch</code> into the <code>LIBS</code> parameter:

   <pre>   perl -Maliased=ExtUtils::MakeMaker,EUMM \
     -e 'my $i = EUMM-&gt;can("import"); no warnings "redefine"; *ExtUtils::MakeMaker::import = sub { &amp;$i; my $targ = caller; my $wm = $targ-&gt;can("WriteMakefile"); *{"${targ}::WriteMakefile"} = sub { my %args = @_; $args{LIBS} =~ s/^/:nosearch /; $wm-&gt;(%args) }; }; do "Makefile.PL" or die "Hack failed: $@"'
   </pre>

   Yes, that is one line and it does work!
</li>

<li>
   Rejoice! The curie code runs!

   <table class="img"><caption>Screenshot of the curie GUI with a test PDF open</caption><tr><td><a href="./posts/2016/05/03/gfx/mingw64-curie.png"><img src="./posts/2016/05/03/windows-build-with-msys2/250x-mingw64-curie.png" width="250" height="200" class="img" /></a></td></tr></table>
</li>

</ol>

<p>At this point, I was quite happy. Now I needed to reproduce these steps so that
they can be used to test every set of changes to the codebase. I could do this
with the Appveyor CI service. Little did I know that there was a lot more work
coming my way.</p>

<h2 id="buildingonappveyor">Building on Appveyor</h2>

<p><li></p>

<p></li></p>

<div class="footnotes">
<hr />
<ol>

<li id="fn:portability"><p>Portability is important to writing robust software and
eventually curie will have an installer of Windows, so it is best to address
any issues early through continuous integration.<a href="#fnref:portability" class="reversefootnote">&#160;&#8617;</a></p></li>

</ol>
</div>

</div>

<div class="inlinefooter">

<span class="pagedate">
Posted <span class="date">Tue 03 May 2016 03:47:24 AM UTC</span>
</span>








<div class="actions">
<ul>

<li><a href="https://github.com/project-renard/project-renard.github.io/edit/source/doc/development/meeting-log/posts/2016/05/03/windows-build-with-msys2.mdwn" rel="nofollow">Edit</a></li>




</ul>
</div>


</div>

</div>
<div class="inlinepage">

<div class="inlineheader">

<span class="header">

<a href="./posts/2016/04/02/week-of-2016-04-02/">week of 2016-04-02</a>

</span>
</div>

<div class="inlinecontent">
<h2 id="chirag">Chirag</h2>

<ul>
<li><p>Work on the Vagrant setup: choose a better base box
<a href="https://github.com/project-renard/devops/issues/4"><img src="https://github-shields.com/github/project-renard/devops/issues/4.svg" alt="project-renard/devops/issues/4" id="project-renarddevopsissues4" /></a></p></li>
<li><p>Refactor tests
<a href="https://github.com/project-renard/curie/issues/58"><img src="https://github-shields.com/github/project-renard/curie/issues/58.svg" alt="project-renard/curie/issues/58" id="project-renardcurieissues58" /></a></p></li>
<li><p>Add the final tests for the keybinding PR
<a href="https://github.com/project-renard/curie/pull/52"><img src="https://github-shields.com/github/project-renard/curie/pull/52.svg" alt="project-renard/curie/pull/52" id="project-renardcuriepull52" /></a></p>

<p>(how to to simulate key press events: <a href="https://github.com/project-renard/curie/issues/64"><img src="https://github-shields.com/github/project-renard/curie/issues/64.svg" alt="project-renard/curie/issues/64" id="project-renardcurieissues64" /></a>
)</p></li>
</ul>

<h2 id="zaki">Zaki</h2>

<ul>
<li><p>Embed AbiWord
<a href="https://github.com/project-renard/curie/issues/57"><img src="https://github-shields.com/github/project-renard/curie/issues/57.svg" alt="project-renard/curie/issues/57" id="project-renardcurieissues57" /></a></p></li>
<li><p>Embed Evince
<a href="https://github.com/project-renard/curie/issues/56"><img src="https://github-shields.com/github/project-renard/curie/issues/56.svg" alt="project-renard/curie/issues/56" id="project-renardcurieissues56" /></a></p></li>
</ul>

</div>

<div class="inlinefooter">

<span class="pagedate">
Posted <span class="date">Sat 09 Apr 2016 02:10:13 AM UTC</span>
</span>








<div class="actions">
<ul>

<li><a href="https://github.com/project-renard/project-renard.github.io/edit/source/doc/development/meeting-log/posts/2016/04/02/week-of-2016-04-02.mdwn" rel="nofollow">Edit</a></li>




</ul>
</div>


</div>

</div>
<div class="inlinepage">

<div class="inlineheader">

<span class="header">

<a href="./posts/2016/03/12/testing-and-planning-features/">testing and planning features</a>

</span>
</div>

<div class="inlinecontent">
<p>We need to start testing the code and automatically running those tests using
continuous integration.</p>

<ul>
<li>Added <a href="https://github.com/project-renard/test-data">test data repository</a>.</li>
<li>Start adding unit tests in PR <a href="https://github.com/project-renard/curie/pull/33"><img src="https://github-shields.com/github/project-renard/curie/pull/33.svg" alt="project-renard/curie/pull/33" id="project-renardcuriepull33" /></a>
to address
issue <a href="https://github.com/project-renard/curie/issues/28"><img src="https://github-shields.com/github/project-renard/curie/issues/28.svg" alt="project-renard/curie/issues/28" id="project-renardcurieissues28" /></a></li>
</ul>

<p>Looked at a review of PDF metadata extraction <a href="https://docs.google.com/document/d/1bmVV89ZozeYsboSTTebKXv3u2vUDAmY3rG2tr5IIl0I/preview">doc</a> (mirrored <a href="https://docs.google.com/document/d/1REI6cZParcQYRBDac6GRgsrjcdRKvloOi26sELZEG0U/preview">here</a>) from this <a href="http://connectedworks.blogspot.com/2010/09/full-review-of-publication-metadata.html">blog</a>.</p>

<p>Adding Travis-CI support:
    - Go to https://travis-ci.org/, select the + sign, click on project-renard https://travis-ci.org/profile/project-renard</p>

<ul>
<li>Zaki: need to add gir1.2-gdl-3 package for docking UIs to Travis-CI package whitelist
(issues are at <a href="https://github.com/project-renard/curie/issues/34"><img src="https://github-shields.com/github/project-renard/curie/issues/34.svg" alt="project-renard/curie/issues/34" id="project-renardcurieissues34" /></a>
, <a href="https://github.com/travis-ci/apt-package-whitelist/issues/2700"><img src="https://github-shields.com/github/travis-ci/apt-package-whitelist/issues/2700.svg" alt="travis-ci/apt-package-whitelist/issues/2700" id="travis-ciapt-package-whitelistissues2700" /></a>
, <a href="https://github.com/travis-ci/apt-package-whitelist/issues/2702"><img src="https://github-shields.com/github/travis-ci/apt-package-whitelist/issues/2702.svg" alt="travis-ci/apt-package-whitelist/issues/2702" id="travis-ciapt-package-whitelistissues2702" /></a>
).</li>
</ul>

<p>Issues carried over from <a href="./posts/2016/03/06/refactoring-recent-gui-additions/">last week</a>:</p>

<ul>
<li><p>Stan: Show number of pages
<a href="https://github.com/project-renard/curie/issues/21"><img src="https://github-shields.com/github/project-renard/curie/issues/21.svg" alt="project-renard/curie/issues/21" id="project-renardcurieissues21" /></a></p></li>
<li><p>Chirag: Deactivate navigation buttons at start and end of document <a href="https://github.com/project-renard/curie/issues/22"><img src="https://github-shields.com/github/project-renard/curie/issues/22.svg" alt="project-renard/curie/issues/22" id="project-renardcurieissues22" /></a></p></li>
</ul>

</div>

<div class="inlinefooter">

<span class="pagedate">
Posted <span class="date">Sat 09 Apr 2016 02:10:13 AM UTC</span>
</span>








<div class="actions">
<ul>

<li><a href="https://github.com/project-renard/project-renard.github.io/edit/source/doc/development/meeting-log/posts/2016/03/12/testing-and-planning-features.mdwn" rel="nofollow">Edit</a></li>




</ul>
</div>


</div>

</div>
<div class="inlinepage">

<div class="inlineheader">

<span class="header">

<a href="./posts/2016/03/27/week-of-2016-03-27/">week of 2016-03-27</a>

</span>
</div>

<div class="inlinecontent">
<p><a href="https://github.com/project-renard/curie/issues/40"><img src="https://github-shields.com/github/project-renard/curie/issues/40.svg" alt="project-renard/curie/issues/40" id="project-renardcurieissues40" /></a></p>

<p><a href="https://github.com/project-renard/curie/pull/53"><img src="https://github-shields.com/github/project-renard/curie/pull/53.svg" alt="project-renard/curie/pull/53" id="project-renardcuriepull53" /></a></p>

<p><a href="https://github.com/project-renard/curie/issues/31"><img src="https://github-shields.com/github/project-renard/curie/issues/31.svg" alt="project-renard/curie/issues/31" id="project-renardcurieissues31" /></a></p>

<p><a href="https://github.com/project-renard/curie/pull/52"><img src="https://github-shields.com/github/project-renard/curie/pull/52.svg" alt="project-renard/curie/pull/52" id="project-renardcuriepull52" /></a></p>

<p><a href="https://github.com/project-renard/devops/issues/2"><img src="https://github-shields.com/github/project-renard/devops/issues/2.svg" alt="project-renard/devops/issues/2" id="project-renarddevopsissues2" /></a></p>

<p><a href="https://github.com/project-renard/devops/pull/3"><img src="https://github-shields.com/github/project-renard/devops/pull/3.svg" alt="project-renard/devops/pull/3" id="project-renarddevopspull3" /></a></p>

<p><a href="https://github.com/project-renard/curie/issues/27"><img src="https://github-shields.com/github/project-renard/curie/issues/27.svg" alt="project-renard/curie/issues/27" id="project-renardcurieissues27" /></a></p>

<p><a href="https://github.com/project-renard/project-renard.github.io/issues/5"><img src="https://github-shields.com/github/project-renard/project-renard.github.io/issues/5.svg" alt="project-renard/project-renard.github.io/issues/5" id="project-renardproject-renard.github.ioissues5" /></a></p>

</div>

<div class="inlinefooter">

<span class="pagedate">
Posted <span class="date">Sat 09 Apr 2016 02:10:13 AM UTC</span>
</span>








<div class="actions">
<ul>

<li><a href="https://github.com/project-renard/project-renard.github.io/edit/source/doc/development/meeting-log/posts/2016/03/27/week-of-2016-03-27.mdwn" rel="nofollow">Edit</a></li>




</ul>
</div>


</div>

</div>
<div class="inlinepage">

<div class="inlineheader">

<span class="header">

<a href="./posts/2016/03/19/improving-gui-navigation-and-tests/">improving the GUI navigation and tests</a>

</span>
</div>

<div class="inlinecontent">
<h2 id="tasks">Tasks</h2>

<h3 id="zaki">Zaki</h3>

<ul>
<li>Create a table of Evince and Okular menus on the wiki</li>
<li>Write GUI tests using mock document and xvfb <a href="https://github.com/project-renard/curie/issues/35"><img src="https://github-shields.com/github/project-renard/curie/issues/35.svg" alt="project-renard/curie/issues/35" id="project-renardcurieissues35" /></a>
(PR at <a href="https://github.com/project-renard/curie/pull/41"><img src="https://github-shields.com/github/project-renard/curie/pull/41.svg" alt="project-renard/curie/pull/41" id="project-renardcuriepull41" /></a>
)</li>
</ul>

<h3 id="stan">Stan</h3>

<ul>
<li>Show number of pages <a href="https://github.com/project-renard/curie/issues/21"><img src="https://github-shields.com/github/project-renard/curie/issues/21.svg" alt="project-renard/curie/issues/21" id="project-renardcurieissues21" /></a>
(PR at <a href="https://github.com/project-renard/curie/pull/43"><img src="https://github-shields.com/github/project-renard/curie/pull/43.svg" alt="project-renard/curie/pull/43" id="project-renardcuriepull43" /></a>
).</li>
</ul>

<table class="img"><caption>GUI showing the label with the number of pages in a PDF document</caption><tr><td><a href="./posts/2016/03/19/gfx/number-of-pages-label.png"><img src="./posts/2016/03/19/improving-gui-navigation-and-tests/250x-number-of-pages-label.png" width="250" height="196" class="img" /></a></td></tr></table>

<p>and the corresponding unit tests (issue: [[!template <span class="error">Error: failed to process template <span class="createlink">git</span> </span>]], PR: [[!template <span class="error">Error: failed to process template <span class="createlink">git</span> </span>]])</p>

<h3 id="chirag">Chirag</h3>

<ul>
<li>Deactivate navigation buttons at start and end of document <a href="https://github.com/project-renard/curie/issues/22"><img src="https://github-shields.com/github/project-renard/curie/issues/22.svg" alt="project-renard/curie/issues/22" id="project-renardcurieissues22" /></a>
(PR at <a href="https://github.com/project-renard/curie/pull/37"><img src="https://github-shields.com/github/project-renard/curie/pull/37.svg" alt="project-renard/curie/pull/37" id="project-renardcuriepull37" /></a>
).</li>
</ul>

<table class="img"><caption>Disable navigation buttons on first page</caption><tr><td><a href="./posts/2016/03/19/gfx/curie-disable-first.png"><img src="./posts/2016/03/19/improving-gui-navigation-and-tests/250x-curie-disable-first.png" width="250" height="197" class="img" /></a></td></tr></table>

<table class="img"><caption>Disable navigation buttons on last page</caption><tr><td><a href="./posts/2016/03/19/gfx/curie-disable-last.png"><img src="./posts/2016/03/19/improving-gui-navigation-and-tests/250x-curie-disable-last.png" width="250" height="197" class="img" /></a></td></tr></table>

<h3 id="zaki">Zaki</h3>

<ul>
<li><p>Refactor Chirag's pull request (issue at <a href="https://github.com/project-renard/curie/issues/38"><img src="https://github-shields.com/github/project-renard/curie/issues/38.svg" alt="project-renard/curie/issues/38" id="project-renardcurieissues38" /></a>
and PR at <a href="https://github.com/project-renard/curie/pull/39"><img src="https://github-shields.com/github/project-renard/curie/pull/39.svg" alt="project-renard/curie/pull/39" id="project-renardcuriepull39" /></a>
).</p></li>
<li><p>Check for errors using Perl::Critic and Test::Spelling. This can be used to check for irregular whitespace and spelling errors among other things
(issue at <a href="https://github.com/project-renard/curie/issues/46"><img src="https://github-shields.com/github/project-renard/curie/issues/46.svg" alt="project-renard/curie/issues/46" id="project-renardcurieissues46" /></a>
and PR at <a href="https://github.com/project-renard/curie/pull/47"><img src="https://github-shields.com/github/project-renard/curie/pull/47.svg" alt="project-renard/curie/pull/47" id="project-renardcuriepull47" /></a>
)</p></li>
</ul>

<table class="img"><caption>Travis-CI: Shows whitespace and code stricture failures</caption><tr><td><a href="./posts/2016/03/19/gfx/curie-perl-critic-fail-1.png"><img src="./posts/2016/03/19/improving-gui-navigation-and-tests/250x-curie-perl-critic-fail-1.png" width="250" height="34" class="img" /></a></td></tr></table>

<table class="img"><caption>Travis-CI: Fix the stricture failures, but whitespace failures remain</caption><tr><td><a href="./posts/2016/03/19/gfx/curie-perl-critic-fail-2.png"><img src="./posts/2016/03/19/improving-gui-navigation-and-tests/250x-curie-perl-critic-fail-2.png" width="250" height="27" class="img" /></a></td></tr></table>

<table class="img"><caption>Travis-CI: Shows documentation spelling failure</caption><tr><td><a href="./posts/2016/03/19/gfx/curie-perl-critic-fail-3.png"><img src="./posts/2016/03/19/improving-gui-navigation-and-tests/250x-curie-perl-critic-fail-3.png" width="250" height="64" class="img" /></a></td></tr></table>

<table class="img"><caption>Travis-CI: Shows all tests (Perl::Critic and POD spelling) now passing</caption><tr><td><a href="./posts/2016/03/19/gfx/curie-perl-critic-success-4.png"><img src="./posts/2016/03/19/improving-gui-navigation-and-tests/250x-curie-perl-critic-success-4.png" width="250" height="40" class="img" /></a></td></tr></table>

<ul>
<li>Add a compatibility layer for GtkScrolledWindow when using a Gtk+ version less v3.8
(issue at <a href="https://github.com/project-renard/curie/issues/42"><img src="https://github-shields.com/github/project-renard/curie/issues/42.svg" alt="project-renard/curie/issues/42" id="project-renardcurieissues42" /></a>
and PR at <a href="https://github.com/project-renard/curie/pull/48"><img src="https://github-shields.com/github/project-renard/curie/pull/48.svg" alt="project-renard/curie/pull/48" id="project-renardcuriepull48" /></a>
)</li>
</ul>

</div>

<div class="inlinefooter">

<span class="pagedate">
Posted <span class="date">Sat 09 Apr 2016 02:10:13 AM UTC</span>
</span>








<div class="actions">
<ul>

<li><a href="https://github.com/project-renard/project-renard.github.io/edit/source/doc/development/meeting-log/posts/2016/03/19/improving-gui-navigation-and-tests.mdwn" rel="nofollow">Edit</a></li>




</ul>
</div>


</div>

</div>
<div class="inlinepage">

<div class="inlineheader">

<span class="header">

<a href="./posts/2016/03/06/refactoring-recent-gui-additions/">refactoring recent GUI additions</a>

</span>
</div>

<div class="inlinecontent">
<p>The pull requests from the previous meeting were discussed and merged. Since
all of the work was performed on a single file, it is now necessary to start
splitting off the code into different modules so that it is easier to work
with.</p>

<p>Zaki: PR to refactor the script <a href="https://github.com/project-renard/curie/pull/24"><img src="https://github-shields.com/github/project-renard/curie/pull/24.svg" alt="project-renard/curie/pull/24" id="project-renardcuriepull24" /></a></p>

<table class="img"><caption>curie GUI with page number entry box and scrollbar</caption><tr><td><a href="./posts/2016/03/06/gfx/simple-gui-with-page-num-and-scrollbar.png"><img src="./posts/2016/03/06/refactoring-recent-gui-additions/250x-simple-gui-with-page-num-and-scrollbar.png" width="250" height="217" class="img" /></a></td></tr></table>

<ul>
<li><p>Stan: Show number of pages
<a href="https://github.com/project-renard/curie/issues/21"><img src="https://github-shields.com/github/project-renard/curie/issues/21.svg" alt="project-renard/curie/issues/21" id="project-renardcurieissues21" /></a></p></li>
<li><p>Chirag: Deactivate navigation buttons at start and end of document <a href="https://github.com/project-renard/curie/issues/22"><img src="https://github-shields.com/github/project-renard/curie/issues/22.svg" alt="project-renard/curie/issues/22" id="project-renardcurieissues22" /></a></p></li>
<li><p>Zaki: Work with PNG data in-memory: PR to create Cairo::ImageSurface in-memory <a href="https://github.com/project-renard/curie/pull/30"><img src="https://github-shields.com/github/project-renard/curie/pull/30.svg" alt="project-renard/curie/pull/30" id="project-renardcuriepull30" /></a>
which addresses issue <a href="https://github.com/project-renard/curie/issues/25"><img src="https://github-shields.com/github/project-renard/curie/issues/25.svg" alt="project-renard/curie/issues/25" id="project-renardcurieissues25" /></a></p></li>
</ul>

</div>

<div class="inlinefooter">

<span class="pagedate">
Posted <span class="date">Sun 06 Mar 2016 09:30:50 PM UTC</span>
</span>








<div class="actions">
<ul>

<li><a href="https://github.com/project-renard/project-renard.github.io/edit/source/doc/development/meeting-log/posts/2016/03/06/refactoring-recent-gui-additions.mdwn" rel="nofollow">Edit</a></li>




</ul>
</div>


</div>

</div>
<div class="inlinepage">

<div class="inlineheader">

<span class="header">

<a href="./posts/2016/02/14/some-project-organisation/">some project organisation</a>

</span>
</div>

<div class="inlinecontent">
<ul>
<li><p>Assigned some tasks for further work on the GUI:</p>

<ul>
<li><p>Stan: put the drawing area in a scrollable region <a href="https://github.com/project-renard/curie/issues/7"><img src="https://github-shields.com/github/project-renard/curie/issues/7.svg" alt="project-renard/curie/issues/7" id="project-renardcurieissues7" /></a></p></li>
<li><p>Chirag: Add a text field for selecting page by number <a href="https://github.com/project-renard/curie/issues/8"><img src="https://github-shields.com/github/project-renard/curie/issues/8.svg" alt="project-renard/curie/issues/8" id="project-renardcurieissues8" /></a></p></li>
<li><p>Zaki: Set the window title to the PDF filename <a href="https://github.com/project-renard/curie/issues/9"><img src="https://github-shields.com/github/project-renard/curie/issues/9.svg" alt="project-renard/curie/issues/9" id="project-renardcurieissues9" /></a>
with PR <a href="https://github.com/project-renard/curie/pull/10"><img src="https://github-shields.com/github/project-renard/curie/pull/10.svg" alt="project-renard/curie/pull/10" id="project-renardcuriepull10" /></a></p></li>
</ul></li>
<li><p>Added a section to the wiki for <a href="../feature/">features</a> that are
found in other similar software that might be worth implementing.</p>

<p>This will be supplemented with screenshots and links to example code.</p></li>
</ul>

</div>

<div class="inlinefooter">

<span class="pagedate">
Posted <span class="date">Sun 14 Feb 2016 03:30:07 AM UTC</span>
</span>








<div class="actions">
<ul>

<li><a href="https://github.com/project-renard/project-renard.github.io/edit/source/doc/development/meeting-log/posts/2016/02/14/some-project-organisation.mdwn" rel="nofollow">Edit</a></li>




</ul>
</div>


</div>

</div>
<div class="inlinepage">

<div class="inlineheader">

<span class="header">

<a href="./posts/2016/02/05/roadmap-planning-session/">Roadmap planning session</a>

</span>
</div>

<div class="inlinecontent">
<p>From <a href="./posts/2016/01/30/using-glade-to-build-curie-gui/">last time</a>, we were going to
look at the MuPDF API for the last remaining task. However, we should step back
and take a look at where we are going before moving forward and why we are
doing each thing.</p>

<h2 id="brainstorming">Brainstorming</h2>

<p>First, we will look at UI functionality then move on to background processing
that is necessary to support each of those.</p>

<ul>
<li><p>UI</p>

<ul>
<li>Display</li>
<li>Navigation</li>
<li>back, forward</li>
<li>jump to page</li>
<li>history list (what was the last page I was at)</li>
</ul>

<p><a href="./posts/2016/02/05/gfx/sketch-page-canvas-layout.jpg"><img src="./posts/2016/02/05/roadmap-planning-session/250x-sketch-page-canvas-layout.jpg" width="250" height="188" alt="Sketch of layout for drawing multiple pages on the canvas" class="img" /></a></p>

<ul>
<li>Reading order: may be embedded in the PDF or might require
extraction</li>
</ul></li>
<li><p>Metadata</p>

<ul>
<li>RDF database</li>
<li>Printing: cover page with metadata and QR code</li>
<li>Summary: automatic summarisation</li>
<li>Example old paper from 1965: <a href="http://dx.doi.org/10.1109/TBME.1965.4502337">A Semi-Automatic Computer-Microscope for the Analysis of Neuronal Morphology</a></li>
<li>Note how the page layout was done manually</li>
<li>BibTeX <a href="https://en.wikibooks.org/wiki/LaTeX/Bibliography_Management#BibTeX">entry types table</a></li>
</ul></li>
<li><p>Binding example:</p>

<ul>
<li>Using Inline::C to bind to <code>libmatio</code>:
<ul>
<li><a href="https://github.com/CBL-ORION/port-test/blob/master/lib/Data/MATLAB/InlineMatio.pm">Getting the compiler flags</a></li>
<li><a href="https://github.com/CBL-ORION/port-test/blob/master/lib/Data/MATLAB.pm">Inline C code</a></li>
</ul></li>
</ul></li>
</ul>

<h2 id="implementationwork">Implementation work</h2>

<p>We continued work on the simple GUI by adding buttons to the Glade GUI for
jumping to the first and last pages and moving forward and backwards
one page at a time. See PR <a href="https://github.com/project-renard/curie/pull/6"><img src="https://github-shields.com/github/project-renard/curie/pull/6.svg" alt="project-renard/curie/pull/6" id="project-renardcuriepull6" /></a>
.</p>

<p>To speed up development, we skipped creating a binding for now and
just used the
<a href="http://mupdf.com/doc/browse/source/tools/mudraw.c"><code>mudraw</code></a>
command to get the PDF page as a PNG image
and <a href="https://cgit.freedesktop.org/poppler/poppler/tree/utils/pdfinfo.cc"><code>pdfinfo</code></a>
command to get the number of pages in the PDF. The following is the
result.</p>

<p><a href="./posts/2016/02/05/gfx/curie-simple-mudraw-pdf-render.png"><img src="./posts/2016/02/05/roadmap-planning-session/250x-curie-simple-mudraw-pdf-render.png" width="250" height="220" alt="curie GUI with a PDF page displayed (from the PDF reference manual) and buttons for navigation" class="img" /></a></p>

<h2 id="furtherreading">Further reading</h2>

<h3 id="books">Books</h3>

<p>These two books discuss and compare how people use books both on paper
and on screens. There are many ideas in them both.</p>

<ul>
<li><p>Marshall, Catherine C. <a href="http://www.morganclaypool.com/doi/abs/10.2200/S00215ED1V01Y200907ICR009">"Reading and writing the electronic
book."</a>
Synthesis lectures on information concepts, retrieval, and services 1.1 (2009):
1-185.</p></li>
<li><p>Dillon, Andrew. Designing usable electronic text: Ergonomic aspects of human
information usage. CRC Press, 2004.</p></li>
</ul>

<h3 id="reviewarticles">Review articles</h3>

<ul>
<li>Koolen, Corina, Ray Siemens, and Alex Garnett. <a href="http://src-online.ca/index.php/src/article/view/71">"Electronic Environments for
Reading: An Annotated Bibliography of Pertinent Hardware and Software (2011)."</a>
Scholarly and Research Communication 3.4 (2012).</li>
</ul>

<h3 id="researcharticles">Research articles</h3>

<ul>
<li><p>Hinckley, K., Bi, X., Pahud, M., Buxton, B. <a href="http://dl.acm.org/citation.cfm?id=2208327">"Informal information gathering
techniques for active reading."</a>
Proceedings of the SIGCHI Conference on Human Factors in Computing Systems.
ACM, 2012.</p>

<p>See this <a href="https://kenhinckley.wordpress.com/2012/05/08/paper-informal-information-gathering-techniques-for-active-reading/">video</a> for a demo.</p></li>
<li><p>Willinsky, John, Alex Garnett, and Angela Pan Wong. <a href="http://quod.lib.umich.edu/j/jep/3336451.0015.102?view=text;rgn=main">"Refurbishing the Camelot
of Scholarship: How to Improve the Digital Contribution of the PDF Research
Article."</a> Journal of Electronic Publishing 15.1 (2012).</p>

<p>This one comes with a <a href="https://pkp.sfu.ca/files/idealizedPDF.pdf">demo PDF</a>
that demonstrates various aspects of what they would like to achieve
which they compare with <a href="http://www.italiavacance.eu/index.php/IJAR/article/download/95/102">the article that they modified</a>.</p>

<p>As you can see, the authors opt to change the way PDFs are published, but
clearly, we can't convince everyone to do that. So instead, we will need
to be able to reformat documents our own way.</p>

<p>That will be the main contribution of Project Renard that nobody has
done yet. I want to call it document resynthesis. I got the
"resynthesis" name from a sound synthesis technique that takes existing
sounds and takes the Fourier components and processes them in order to
make new sounds.</p></li>
</ul>

</div>

<div class="inlinefooter">

<span class="pagedate">
Posted <span class="date">Fri 05 Feb 2016 06:09:21 PM UTC</span>
</span>








<div class="actions">
<ul>

<li><a href="https://github.com/project-renard/project-renard.github.io/edit/source/doc/development/meeting-log/posts/2016/02/05/roadmap-planning-session.mdwn" rel="nofollow">Edit</a></li>




</ul>
</div>


</div>

</div>
<div class="inlinepage">

<div class="inlineheader">

<span class="header">

<a href="./posts/2016/01/30/using-glade-to-build-curie-gui/">Using Glade to build curie GUI</a>

</span>
</div>

<div class="inlinecontent">
<h2 id="agenda">Agenda</h2>

<ul>
<li>Discuss Glade tutorial.</li>
<li>Start a simple GUI in Glade for <strong>curie</strong>.</li>
</ul>

<h2 id="taskscompleted">Tasks completed</h2>

<ul>
<li><p>Glade tutorial</p>

<ul>
<li>Tutorial code <a href="https://github.com/zmughal/learning-gtk/tree/master/charter">https://github.com/zmughal/learning-gtk/tree/master/charter</a>
<ul>
<li>If you are following this tutorial, note that there are changes that have occurred in GTK+3.0 since it was written.
For example, the "expose-event" signal is now the "draw" signal: <a href="https://developer.gnome.org/gtk3/stable/ch25s02.html#id-1.6.3.4.11">https://developer.gnome.org/gtk3/stable/ch25s02.html#id-1.6.3.4.11</a>.</li>
</ul></li>
<li>Look up callback signature:
<ul>
<li><a href="https://developer.gnome.org/gtk3/stable/GtkDrawingArea.html">https://developer.gnome.org/gtk3/stable/GtkDrawingArea.html</a></li>
<li><a href="https://developer.gnome.org/gtk3/stable/GtkWidget.html#GtkWidget-draw">https://developer.gnome.org/gtk3/stable/GtkWidget.html#GtkWidget-draw</a></li>
</ul></li>
</ul></li>
<li><p>Discuss the display of supplemental information along with document</p>

<ul>
<li>Knowledge Graph <a href="https://en.wikipedia.org/wiki/Knowledge_Graph">https://en.wikipedia.org/wiki/Knowledge_Graph</a>: Google's infoboxes which show up on search.</li>
<li>SPARQL: query langauge for semantic web data.</li>
<li>Utopia <a href="http://utopiadocs.com/">http://utopiadocs.com/</a>: a PDF reader that shows social
information and retrieves from sources such as the Protein Data Bank.</li>
<li>Reflect: browser plugin for chemistry identifier lookup
<ul>
<li><a href="http://epafilis.info/projects.html">http://epafilis.info/projects.html</a></li>
<li><a href="http://reflect.ws/">http://reflect.ws/</a></li>
<li><a href="http://www.nature.com/nbt/journal/v27/n6/full/nbt0609-508.html">http://www.nature.com/nbt/journal/v27/n6/full/nbt0609-508.html</a></li>
</ul></li>
</ul></li>
<li><p>Design a GUI for displaying images of the document</p>

<ul>
<li>PR <a href="https://github.com/project-renard/curie/pull/6"><img src="https://github-shields.com/github/project-renard/curie/pull/6.svg" alt="project-renard/curie/pull/6" id="project-renardcuriepull6" /></a>
(and progress images)</li>
<li>Examples
<ul>
<li>Anjuta: IDE with docking. Uses GDL <a href="http://anjuta.org/">http://anjuta.org/</a>.</li>
<li>Example of simple PDF viewer using Poppler <a href="https://yassernour.wordpress.com/2010/04/04/how-hard-to-build-a-pdf-viewer/">https://yassernour.wordpress.com/2010/04/04/how-hard-to-build-a-pdf-viewer/</a>.</li>
</ul></li>
<li>Display a single image
<ul>
<li>Cairo for loading PNG
<ul>
<li><a href="http://cairographics.org/cookbook/perl_cairo_module/">http://cairographics.org/cookbook/perl_cairo_module/</a></li>
<li><a href="http://zetcode.com/gfx/cairo/cairoimages/">http://zetcode.com/gfx/cairo/cairoimages/</a></li>
</ul></li>
</ul></li>
<li><p>First attempt: draw a green colour on the whole drawing area:</p>

<p><a href="./posts/2016/01/30/gfx/curie-green-background-drawingarea.png"><img src="./posts/2016/01/30/using-glade-to-build-curie-gui/250x-curie-green-background-drawingarea.png" width="250" height="197" alt="curie GUI with green colour" class="img right" /></a></p></li>
<li><p>Second attempt: draw an image read from a file on the drawing area:</p>

<p><a href="./posts/2016/01/30/gfx/curie-image-peppers-drawingarea.png"><img src="./posts/2016/01/30/using-glade-to-build-curie-gui/250x-curie-image-peppers-drawingarea.png" width="250" height="197" alt="curie GUI with image of peppers" class="img right" /></a></p></li>
</ul></li>
</ul>

<h2 id="tasksinprogress">Tasks in progress</h2>

<ul>
<li>PDF rendering using MuPDF library
<ul>
<li>Install MuPDF
<a href="http://mupdf.com/downloads/">http://mupdf.com/downloads/</a>
<pre>
mkdir build; cd build
wget 'http://mupdf.com/downloads/mupdf-1.8-source.tar.gz'
tar xvvzf mupdf-1.8-source.tar.gz
cd mupdf-1.8-source
make HAVE_GLFW=no
make HAVE_GLFW=no install
</pre></li>
<li>Make a note of the OpenGL viewer flag at <a href="https://github.com/project-renard/p5-Alien-MuPDF/issues/3"><img src="https://github-shields.com/github/project-renard/p5-Alien-MuPDF/issues/3.svg" alt="project-renard/p5-Alien-MuPDF/issues/3" id="project-renardp5-alien-mupdfissues3" /></a>
.</li>
</ul></li>
</ul>

<h2 id="tasksremaining">Tasks remaining</h2>

<ul>
<li><p>Look into MuPDF API.</p>

<ul>
<li><a href="http://mupdf.com/docs/overview">http://mupdf.com/docs/overview</a></li>
<li><a href="http://mupdf.com/docs/">http://mupdf.com/docs/</a></li>
<li>See issue <a href="https://github.com/project-renard/p5-Incunabula-Format-PDF/issues/1"><img src="https://github-shields.com/github/project-renard/p5-Incunabula-Format-PDF/issues/1.svg" alt="project-renard/p5-Incunabula-Format-PDF/issues/1" id="project-renardp5-incunabula-format-pdfissues1" /></a>
.</li>
</ul></li>
<li><p>Refactor GUI code.</p></li>
</ul>

</div>

<div class="inlinefooter">

<span class="pagedate">
Posted <span class="date">Sat 30 Jan 2016 11:23:38 PM UTC</span>
</span>








<div class="actions">
<ul>

<li><a href="https://github.com/project-renard/project-renard.github.io/edit/source/doc/development/meeting-log/posts/2016/01/30/using-glade-to-build-curie-gui.mdwn" rel="nofollow">Edit</a></li>




</ul>
</div>


</div>

</div>
<div class="inlinepage">

<div class="inlineheader">

<span class="header">

<a href="./posts/2016/01/24/initial-setup/">Initial setup</a>

</span>
</div>

<div class="inlinecontent">
<h2 id="agenda">Agenda</h2>

<ul>
<li>Record all steps taken today to a post on the project-renard wiki.
<ul>
<li>That means that this EtherPad document will become a page on the wiki.</li>
</ul></li>
<li><p>Choose a standard version of Perl 5 to work on. The code will not work on
older versions. This is so that we can use modern features without worrying
about backwards compatibility.</p>

<p>Perl v5.20 is a good choice right now. It supports method signatures as a
built-in feature.</p></li>
<li><p>Set up GTK+ 3 on Linux so that it can run the <strong>curie</strong> code.</p>

<ul>
<li>This is related to issue "GTK+ Linux setup" <a href="https://github.com/project-renard/curie/issues/2"><img src="https://github-shields.com/github/project-renard/curie/issues/2.svg" alt="project-renard/curie/issues/2" id="project-renardcurieissues2" /></a>
.</li>
</ul></li>
</ul>

<h2 id="taskscompleted">Tasks completed</h2>

<ul>
<li><p><strong>curie</strong>: Install development packages for libgtk-3.0 <a href="https://developer.gnome.org/gtk3/">https://developer.gnome.org/gtk3/</a> on Debian GNU/Linux.</p>

<ul>
<li>Install the dependencies on Debian by running:
<pre>
cd curie
sudo xargs apt-get install \
  -y --no-install-recommends \
  &lt; debian-packages
</pre></li>
</ul></li>
<li><p><strong>base</strong>: Make sure the version of Perl 5 you have is v5.20 or greater.</p>

<ul>
<li>If you do not have that version of Perl 5, you can use <code>perlbrew</code> to set it up.
Follow the instructions at <a href="http://perlbrew.pl/">http://perlbrew.pl/</a>.</li>
</ul></li>
<li><p><strong>base</strong>: We will use cpanm to install the Perl modules that we need. It can be
installed by running</p>

<p><code>
  perlbrew install-cpanm
</code></p>

<p>or if you do not have perlbrew, following the instructions at
<a href="https://github.com/miyagawa/cpanminus#installing-to-system-perl">https://github.com/miyagawa/cpanminus#installing-to-system-perl</a>:</p>

<p><code>
  cpan App::cpanminus
</code></p></li>
<li><p><strong>curie</strong>: Removed the Gtk3::Ex::PDFViewer code which was causing problems</p>

<ul>
<li>PR <a href="https://github.com/project-renard/curie/pull/3"><img src="https://github-shields.com/github/project-renard/curie/pull/3.svg" alt="project-renard/curie/pull/3" id="project-renardcuriepull3" /></a>
.</li>
</ul></li>
<li><p><strong>curie</strong>: Install the Perl CPAN packages needed for Gtk3.</p>

<ul>
<li>This can be done more easily by creating a <code>cpanfile</code> which lists the requirements.</li>
<li>PR <a href="https://github.com/project-renard/curie/pull/4"><img src="https://github-shields.com/github/project-renard/curie/pull/4.svg" alt="project-renard/curie/pull/4" id="project-renardcuriepull4" /></a>
.</li>
<li><p>Now that the <code>cpanfile</code> is available, you can install the dependencies by running</p>

<p><code>
cpanm --installdeps .
</code></p></li>
</ul></li>
<li><p><strong>curie</strong>: Install and investigate the Glade UI designer.</p>

<ul>
<li><p>Glade can be installed by running the commands:
<code>
sudo apt-get install --no-install-recommends glade
</code></p></li>
<li><p>There is a Glade tutorial at <a href="http://live.gnome.org/Glade/Tutorials">http://live.gnome.org/Glade/Tutorials</a>.</p></li>
<li><p>We need to see if Glade <a href="https://glade.gnome.org/">https://glade.gnome.org/</a> can handle the docking widgets
that are provided by libgdl <a href="https://developer.gnome.org/gdl/">https://developer.gnome.org/gdl/</a>.</p></li>
</ul></li>
</ul>

</div>

<div class="inlinefooter">

<span class="pagedate">
Posted <span class="date">Sun 24 Jan 2016 04:45:06 AM UTC</span>
</span>








<div class="actions">
<ul>

<li><a href="https://github.com/project-renard/project-renard.github.io/edit/source/doc/development/meeting-log/posts/2016/01/24/initial-setup.mdwn" rel="nofollow">Edit</a></li>




</ul>
</div>


</div>

</div>


</div>





</div>

<div id="footer" class="pagefooter">

<div id="pageinfo">




<div id="backlinks">
Links:

<a href="./posts/">meeting-log/posts</a>

<a href="../../../sidebar/">sidebar</a>


</div>






<div class="pagedate">
Last edited <span class="date">Sat 09 Apr 2016 02:10:13 AM UTC</span>
<!-- Created <span class="date">Sat 09 Apr 2016 02:10:13 AM UTC</span> -->
</div>

</div>


<!-- from Project Renard -->
</div>

</div>

</body>
</html>
